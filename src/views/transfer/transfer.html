<section class="transfer fill-height" ref="transfer">
  <v-dialog v-model="qrReadingError" fullscreen persistent scrollable>
    <v-card>
      <v-toolbar dark color="primary">
        <v-toolbar-title class="text-capitalize">Wrong QR</v-toolbar-title>
        <v-spacer></v-spacer>
        <v-btn icon flat @click="qrReadingError = false">
          <v-icon :color="$route.meta.accent">
            close
          </v-icon>
        </v-btn>
      </v-toolbar>
      <v-card-text>
        <p>There was an error with the QR.</p>
        <p>Couldn't find the needed data</p>
      </v-card-text>
    </v-card>
  </v-dialog>


  <v-layout column fill-height>
    <div class="text-xs-center my-0 div-toggle-buttons">
      <v-btn-toggle v-model="selectedTab"  mandatory class="round elevation-0">
        <v-btn flat v-for="tab in tabs" :key="tab" class="px-5 round" exact :to="{query:{tab: tab}}">{{tab}}
        </v-btn>
      </v-btn-toggle>
    </div>
    <div class="mx-3">
      <div class="text-xs-left">
        <p class="mb-1" v-if="active == 'receive'">To</p>
        <p class="mb-1" v-else>
          <span style="display:inline-block;  width:50%;">From</span>
          <span style="display:inline-block; width:45%; margin-right: 5%; text-align: right;">
            <v-btn small align-end icon v-if="active == 'send'" class="pr-4" @click="scanQR()">
              Scan QR
              <v-icon class="ml-2">fas fa-qrcode</v-icon>
            </v-btn>

          </span>
        </p>
      </div>

      <div>
        <v-select @change="selectWallet" :items="computedWallets" v-model="selectedWallet"
          return-object>

          <template slot="selection" slot-scope="data">
            <v-flex class="text-capitalize" >
              {{ data.item.name }}
            </v-flex>
            <v-spacer></v-spacer>
            <v-flex justify-end class="text-xs-right">
              {{ data.item.totalAmount }} {{data.item.currency}}
            </v-flex>
          </template>
          <template slot="item" slot-scope="data">
              <v-flex class="text-capitalize" >
                  {{ data.item.name }}
                </v-flex>
                <v-spacer></v-spacer>
                <v-flex justify-end class="text-xs-right">
                  {{ data.item.totalAmount }} {{data.item.currency}}
                </v-flex>
          </template>
        </v-select>
      </div>

      <FormComponent ref="formComponent" :formObject="formObject" :selectedTab="selectedTab" :investments="investments"
        :wallets="wallets" :selectedWallet="selectedWallet" @formValidation="formValidation($event)" :fee="fee">
      </FormComponent>

      <v-layout column wrap v-if="$route.query.tab != 'receive'">
        <v-flex>Fee: {{fee.toFixed(2)}} {{selectedWallet.currency}}</v-flex>
        <span v-if="(formObject.to.currency && selectedWallet.currency != formObject.to.currency)">
          <v-flex>Exchange rate: {{exchangeRate}}</v-flex>
          <v-flex v-if="formObject.amount">Your rate: {{yourExchangeRate}}</v-flex>
        </span>
      </v-layout>

      <div>
        <v-btn class="mx-0 mt-3" style="width: 100%;" color="accent" dark @click="transferConfirmed">
          <div v-if="$route.query.tab === 'receive'">
            Generate QR
          </div>
          <div v-if="$route.query.tab === 'send'">
            Send Tokens
          </div>
        </v-btn>
      </div>
    </div>
    <!-- </v-card-text>


    </v-card> -->

  </v-layout>

  <TransactionInfoDialog :dialog="transactionInfoDialog" :closeDialog="closeTransactionInfoDialog"
    :selectedTab="selectedTab" :wallets="wallets" :send="send" :selectedWallet="selectedWallet"
    :selectWallet="selectWallet" :formObject="formObject" v-if="selectedWallet.address" :fee="fee">
  </TransactionInfoDialog>

  <QrScannerDialog :dialog="qrScannerDialog" :closeDialog="closeQrScannerDialog" :selectedTab="selectedTab"
    :formObject="formObject"></QrScannerDialog>

  <QrDialog :dialog="qrDialog" :closeDialog="closeQrDialog" :formObject="formObject" :selectedWallet="selectedWallet"
    :selectedTab="selectedTab"></QrDialog>

</section>