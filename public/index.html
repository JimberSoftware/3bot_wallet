<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="icon" href="<%= BASE_URL %>favicon.ico">
  <title>3bot_wallet</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
    integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
</head>

<body>
  <noscript>
    <strong>We're sorry but 3bot_wallet doesn't work properly without JavaScript enabled. Please enable it to
      continue.</strong>
  </noscript>
  <div id="app"></div>
  <!-- built files will be auto injected -->
  <script>
    if (document.getElementById('webview_copy') == null) {
      console.log("Adding clipboard hack");
      let cbh_css = `
    #cbh-custom-menu {
        user-select: none;
        all: initial;
        display: none;
        z-index: 9999999;
        position: fixed;
        background-color: #fff;
        border: 1px solid #ddd;
        overflow: hidden;
        width: 120px;
        white-space: nowrap;
        font-family: sans-serif;
        box-shadow: 2px 2px 7px 0px rgba(50, 50, 50, 0.5);
    }

    #cbh-custom-menu li {

        padding: 5px 10px;
    }

    #cbh-custom-menu li:hover {
        background-color: #4679BD;
        color: #fff;
        cursor: pointer;
    }
`;

      var cbh_html = `
<ul id='cbh-custom-menu'>
    <li id="webview_copy">Copy</li>
    <li id="webview_paste">Paste</li>
</ul>
`;

      /* inject CSS */
      let cbh_head = document.head || document.getElementsByTagName('head')[0];
      let cbh_style = document.createElement('style');
      cbh_style.type = 'text/css';
      cbh_style.appendChild(document.createTextNode(cbh_css));
      console.log(cbh_style);
      cbh_head.appendChild(cbh_style);
      document.body.innerHTML += cbh_html;

      /* JS code */

      var webview_copy_value = '';
      var webview_selected_item = {};
      window.addEventListener('click', function (e) {
        let cbh_menu = document.getElementById('cbh-custom-menu');
        cbh_menu.style.display = 'none';

      }, true);

      document.addEventListener('contextmenu', function (evt) {
        webview_selected_item = evt.path[0];
        webview_copy_value = window.getSelection().toString();
        let cbh_menu = document.getElementById('cbh-custom-menu');
        cbh_menu.style.top = `${evt.clientY}px`;
        cbh_menu.style.left = `${evt.clientX}px`;
        if (window.innerHeight - 50 < evt.clientY) {
          cbh_menu.style.top = `${evt.clientY - 50}px`;
        }
        if (window.innerHeight - 50 < evt.clientX) {
          cbh_menu.style.left = `${evt.clientX - 70}px`;
        }

        cbh_menu.style.display = 'block';
        evt.preventDefault();
      }, false);

      document.getElementById('webview_copy').onclick = function () {

        window.flutter_inappwebview.callHandler('COPY', webview_copy_value).then(function (result) {

        });
      }
      document.getElementById('webview_paste').onclick = function () {

        window.flutter_inappwebview.callHandler('PASTE', webview_copy_value).then(function (result) {
          webview_selected_item.select();
          document.execCommand("insertHTML", false, result);
        });
      }



    }
  </script>
</body>

</html>